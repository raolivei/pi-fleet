# Flux UI Values
# Wraps Weave GitOps Helm chart for Flux UI

# Global configuration
global:
  domain: eldertree.local
  clusterIssuer: selfsigned-cluster-issuer

# Weave GitOps configuration
# Values passed directly to weave-gitops dependency (gitops-server chart)
# See: https://github.com/weaveworks/weave-gitops/blob/main/charts/gitops-server/values.yaml
weave-gitops:
  enabled: true
  
  # Service configuration
  service:
    type: ClusterIP
    port: 9001
  
  # Ingress configuration
  ingress:
    enabled: true
    ingressClassName: traefik
    hosts:
      - host: flux.eldertree.local
        paths:
          - path: /
            pathType: Prefix
    tls:
      - secretName: flux-ui-tls
        hosts:
          - flux.eldertree.local
    annotations:
      cert-manager.io/cluster-issuer: selfsigned-cluster-issuer
  
  # Resource limits for Raspberry Pi
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 128Mi
  
  # Replica count
  replicaCount: 1
  
  # Security context
  securityContext:
    runAsNonRoot: true
    runAsUser: 65534
    fsGroup: 65534
  
  # Service account
  serviceAccount:
    create: true
    name: flux-ui
  
  # RBAC - Weave GitOps needs cluster-admin to manage Flux resources
  rbac:
    create: true
    clusterRole: true
  
  # Admin user configuration - required for authentication
  adminUser:
    create: true
    createClusterRole: true
    username: admin
    # passwordHash injected from Vault via HelmRelease valuesFrom

