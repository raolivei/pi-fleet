# WireGuard Client Configuration - Split Tunnel for k3s Access
# This config routes ONLY cluster traffic through the VPN
# All other internet traffic bypasses the VPN

[Interface]
# Client tunnel address (change for each client: .2, .3, .4, etc.)
Address = 10.8.0.2/32

# Client private key (generate with: wg genkey)
# REPLACE THIS WITH YOUR CLIENT PRIVATE KEY
PrivateKey = <CLIENT_PRIVATE_KEY>

# DNS server - points to WireGuard server for cluster DNS resolution
# The server will forward cluster.local queries to k3s CoreDNS
DNS = 10.8.0.1

[Peer]
# Server public key (from server's: wg pubkey < /etc/wireguard/privatekey)
# REPLACE THIS WITH YOUR SERVER PUBLIC KEY
PublicKey = <SERVER_PUBLIC_KEY>

# Server endpoint - REPLACE with your actual public IP or domain
Endpoint = <YOUR_PUBLIC_IP_OR_DOMAIN>:51820

# Split-tunnel configuration - ONLY these networks go through VPN
# This is the key to split-tunneling: we don't route 0.0.0.0/0
AllowedIPs = 10.8.0.0/24, 10.42.0.0/16, 10.43.0.0/16, 192.168.1.0/24

# Keep connection alive through NAT
PersistentKeepalive = 25

# Network breakdown:
# - 10.8.0.0/24    : WireGuard tunnel network
# - 10.42.0.0/16   : k3s Pod network (flannel/default)
# - 10.43.0.0/16   : k3s Service ClusterIP network
# - 192.168.1.0/24 : LAN network (adjust to your actual LAN subnet)
#
# If your LAN uses a different subnet (e.g., 10.0.0.0/24 or 192.168.0.0/24),
# replace 192.168.1.0/24 with your actual subnet.
#
# To add more networks, append them to AllowedIPs:
# AllowedIPs = 10.8.0.0/24, 10.42.0.0/16, 10.43.0.0/16, 192.168.1.0/24, X.X.X.X/XX

