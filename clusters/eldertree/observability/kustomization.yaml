apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
# Observability - Monitoring, metrics, and logging infrastructure
resources:
  - namespace.yaml # Observability namespace
  - weave-gitops-gitrepository.yaml # GitRepository for Weave GitOps charts (from GitHub)
  - monitoring-stack-helmrelease.yaml # Prometheus + Grafana monitoring stack
  - pihole-scrape-config.yaml # Pi-hole Prometheus scrape configuration
  - visage-scrape-config.yaml # Visage metrics scrape configuration
  - vault-scrape-config.yaml # Vault telemetry scrape configuration
  - flux-ui-externalsecret.yaml # Flux UI admin password from Vault
  - flux-ui-helmrelease.yaml # Flux UI (Weave GitOps) for managing FluxCD resources
  - dex-helmrepository.yaml # Dex Helm chart repo (charts.dexidp.io)
  - dex-externalsecret.yaml # GitHub OAuth client credentials from Vault
  - dex-helmrelease.yaml # Dex OIDC provider for Flux UI GitHub login
  - dex-rbac.yaml # ClusterRoleBinding for GitHub user via OIDC
  - ca-bundle-configmap.yaml # Eldertree CA cert for pods verifying CA-signed TLS
  - postgres-exporter.yaml # PostgreSQL metrics exporter for all DB instances
  - redis-exporter.yaml # Redis metrics exporter for all Redis instances
  # grafana-dashboards-configmap.yaml removed - Longhorn no longer in use
  # - traefik-servicemonitor.yaml # Traefik metrics (DISABLED - requires Prometheus Operator / PodMonitor CRD)
